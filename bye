Exception in thread Thread-20 (run_server):
Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/root/.ipykernel/1453/command-5011140253560757-3431679890", line 16, in run_server
NameError: name 'app' is not defined

============================================================
ğŸš€ STARTING FASTAPI SERVER
============================================================

ğŸ“¡ Server will be available at:
   ğŸŒ http://localhost:8000
   ğŸ“– API Docs: http://localhost:8000/docs
   ğŸ”§ Alternative Docs: http://localhost:8000/redoc

â¹ï¸  To stop the server, run: stop_server()
============================================================

âœ… Server started in background thread!
Wait a few seconds for it to fully initialize...
âœ… Server is ready! You can now test the API.


ğŸ§ª Testing API endpoints...

1ï¸âƒ£  Testing /health endpoint:
   âŒ Error: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /health (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f89cc2dc700>: Failed to establish a new connection: [Errno 111] Connection refused'))
   Server might not be running yet. Make sure Cell 4 is executing!

âœ… Health check passed!

2ï¸âƒ£  Ready to test /generate endpoint:
   Use the code below to generate a video:


import requests

files = {
    'audio': open('/Volumes/lab37_catalog/ifstrolley/trolley/Thank you for bookin (1).wav', 'rb'),
    'image': open('/Volumes/lab37_catalog/ifstrolley/trolley/new.png', 'rb'),
}
data = {'num_frames': 50, 'face_scale': 2.3}

response = requests.post('http://localhost:8000/generate', files=files, data=data)
result = response.json()

print(f"Task ID: {result['task_id']}")
print(f"Status: {result['status']}")
print(f"Inference time: {result['inference_time']}s")
print(f"Video path: {result['video_path']}")
