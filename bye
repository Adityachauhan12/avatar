Result of first 2 cells 
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Found existing installation: flash-attn 2.3.6
Not uninstalling flash-attn at /databricks/python3/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28
Can't uninstall 'flash-attn'. No files were found to uninstall.
WARNING: Skipping mmcv-full as it is not installed.
WARNING: Skipping mmcv as it is not installed.
WARNING: Skipping mmdet as it is not installed.
WARNING: Skipping mmpose as it is not installed.
Found existing installation: numpy 1.26.4
Not uninstalling numpy at /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28
Can't uninstall 'numpy'. No files were found to uninstall.
Found existing installation: urllib3 1.26.14
Not uninstalling urllib3 at /databricks/python3/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28
Can't uninstall 'urllib3'. No files were found to uninstall.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Collecting numpy==1.23.5
  Using cached numpy-1.23.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.1 MB)
Requirement already satisfied: urllib3<2.0 in /databricks/python3/lib/python3.10/site-packages (1.26.14)
Installing collected packages: numpy
  Attempting uninstall: numpy
    Found existing installation: numpy 1.26.4
    Not uninstalling numpy at /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28
    Can't uninstall 'numpy'. No files were found to uninstall.
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
petastorm 0.12.1 requires pyspark>=2.1.0, which is not installed.
databricks-feature-engineering 0.2.1 requires pyspark<4,>=3.1.2, which is not installed.
skops 0.13.0 requires numpy>=1.25.0, but you have numpy 1.23.5 which is incompatible.
ydata-profiling 4.2.0 requires pydantic<2,>=1.8.1, but you have pydantic 2.12.5 which is incompatible.
torchvision 0.15.2+cu118 requires torch==2.0.1, but you have torch 2.10.0 which is incompatible.
tensorflow 2.14.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 6.33.5 which is incompatible.
databricks-feature-engineering 0.2.1 requires mlflow-skinny[databricks]<3,>=2.4.0, but you have mlflow-skinny 3.9.0 which is incompatible.
databricks-feature-engineering 0.2.1 requires protobuf<5,>=3.12.0, but you have protobuf 6.33.5 which is incompatible.
Successfully installed numpy-1.23.5
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Looking in links: https://download.openmmlab.com/mmcv/dist/cu118/torch2.0/index.html
Collecting mmcv==2.0.1
  Downloading https://download.openmmlab.com/mmcv/dist/cu118/torch2.0.0/mmcv-2.0.1-cp310-cp310-manylinux1_x86_64.whl (74.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 74.4/74.4 MB 7.3 MB/s eta 0:00:00
Collecting mmengine>=0.3.0
  Downloading mmengine-0.10.7-py3-none-any.whl (452 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 452.7/452.7 kB 8.8 MB/s eta 0:00:00
Collecting opencv-python>=3
  Downloading opencv_python-4.13.0.92-cp37-abi3-manylinux_2_28_x86_64.whl (72.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 72.9/72.9 MB 7.7 MB/s eta 0:00:00
Requirement already satisfied: pyyaml in /databricks/python3/lib/python3.10/site-packages (from mmcv==2.0.1) (6.0)
Collecting addict
  Downloading addict-2.4.0-py3-none-any.whl (3.8 kB)
Requirement already satisfied: Pillow in /databricks/python3/lib/python3.10/site-packages (from mmcv==2.0.1) (9.4.0)
Requirement already satisfied: numpy in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from mmcv==2.0.1) (1.23.5)
Requirement already satisfied: yapf in /databricks/python3/lib/python3.10/site-packages (from mmcv==2.0.1) (0.33.0)
Requirement already satisfied: packaging in /databricks/python3/lib/python3.10/site-packages (from mmcv==2.0.1) (23.2)
Requirement already satisfied: matplotlib in /databricks/python3/lib/python3.10/site-packages (from mmengine>=0.3.0->mmcv==2.0.1) (3.7.0)
Collecting rich
  Using cached rich-14.3.2-py3-none-any.whl (309 kB)
Requirement already satisfied: termcolor in /databricks/python3/lib/python3.10/site-packages (from mmengine>=0.3.0->mmcv==2.0.1) (2.4.0)
Collecting numpy
  Using cached numpy-2.2.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.8 MB)
Requirement already satisfied: tomli>=2.0.1 in /databricks/python3/lib/python3.10/site-packages (from yapf->mmcv==2.0.1) (2.0.1)
Requirement already satisfied: pyparsing>=2.3.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (3.0.9)
Requirement already satisfied: fonttools>=4.22.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (4.25.0)
Requirement already satisfied: python-dateutil>=2.7 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (2.8.2)
Requirement already satisfied: cycler>=0.10 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (0.11.0)
Requirement already satisfied: kiwisolver>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (1.4.4)
Requirement already satisfied: contourpy>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (1.0.5)
Collecting markdown-it-py>=2.2.0
  Using cached markdown_it_py-4.0.0-py3-none-any.whl (87 kB)
Collecting pygments<3.0.0,>=2.13.0
  Using cached pygments-2.19.2-py3-none-any.whl (1.2 MB)
Collecting mdurl~=0.1
  Using cached mdurl-0.1.2-py3-none-any.whl (10.0 kB)
Requirement already satisfied: six>=1.5 in /usr/lib/python3/dist-packages (from python-dateutil>=2.7->matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (1.16.0)
Installing collected packages: addict, pygments, numpy, mdurl, opencv-python, markdown-it-py, rich, mmengine, mmcv
  Attempting uninstall: pygments
    Found existing installation: Pygments 2.11.2
    Not uninstalling pygments at /databricks/python3/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28
    Can't uninstall 'Pygments'. No files were found to uninstall.
  Attempting uninstall: numpy
    Found existing installation: numpy 1.23.5
    Uninstalling numpy-1.23.5:
      Successfully uninstalled numpy-1.23.5
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
petastorm 0.12.1 requires pyspark>=2.1.0, which is not installed.
nbclassic 0.5.2 requires prometheus-client, which is not installed.
jupyter-server 1.23.4 requires prometheus-client, which is not installed.
databricks-feature-engineering 0.2.1 requires pyspark<4,>=3.1.2, which is not installed.
ydata-profiling 4.2.0 requires numpy<1.24,>=1.16.0, but you have numpy 2.2.6 which is incompatible.
ydata-profiling 4.2.0 requires pydantic<2,>=1.8.1, but you have pydantic 2.12.5 which is incompatible.
torchvision 0.15.2+cu118 requires torch==2.0.1, but you have torch 2.10.0 which is incompatible.
tensorflow 2.14.1 requires numpy<2.0.0,>=1.23.5, but you have numpy 2.2.6 which is incompatible.
tensorflow 2.14.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 6.33.5 which is incompatible.
scipy 1.10.0 requires numpy<1.27.0,>=1.19.5, but you have numpy 2.2.6 which is incompatible.
numba 0.56.4 requires numpy<1.24,>=1.18, but you have numpy 2.2.6 which is incompatible.
langchain 0.0.348 requires numpy<2,>=1, but you have numpy 2.2.6 which is incompatible.
jupyter-server 1.23.4 requires anyio<4,>=3.1.0, but you have anyio 4.12.1 which is incompatible.
databricks-feature-engineering 0.2.1 requires mlflow-skinny[databricks]<3,>=2.4.0, but you have mlflow-skinny 3.9.0 which is incompatible.
databricks-feature-engineering 0.2.1 requires numpy<2,>=1.19.2, but you have numpy 2.2.6 which is incompatible.
databricks-feature-engineering 0.2.1 requires protobuf<5,>=3.12.0, but you have protobuf 6.33.5 which is incompatible.
Successfully installed addict-2.4.0 markdown-it-py-4.0.0 mdurl-0.1.2 mmcv-2.0.1 mmengine-0.10.7 numpy-2.2.6 opencv-python-4.13.0.92 pygments-2.19.2 rich-14.3.2
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Collecting mmdet==3.1.0
  Downloading mmdet-3.1.0-py3-none-any.whl (2.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.0/2.0 MB 32.4 MB/s eta 0:00:00
Collecting mmpose==1.1.0
  Downloading mmpose-1.1.0-py2.py3-none-any.whl (1.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.3/1.3 MB 55.6 MB/s eta 0:00:00
Requirement already satisfied: numpy in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from mmdet==3.1.0) (2.2.6)
Requirement already satisfied: scipy in /databricks/python3/lib/python3.10/site-packages (from mmdet==3.1.0) (1.10.0)
Collecting terminaltables
  Downloading terminaltables-3.1.10-py2.py3-none-any.whl (15 kB)
Requirement already satisfied: matplotlib in /databricks/python3/lib/python3.10/site-packages (from mmdet==3.1.0) (3.7.0)
Requirement already satisfied: six in /usr/lib/python3/dist-packages (from mmdet==3.1.0) (1.16.0)
Collecting shapely
  Downloading shapely-2.1.2-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (3.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.1/3.1 MB 74.9 MB/s eta 0:00:00
Collecting pycocotools
  Downloading pycocotools-2.0.11-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (472 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 472.5/472.5 kB 40.6 MB/s eta 0:00:00
Collecting chumpy
  Downloading chumpy-0.70.tar.gz (50 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 50.6/50.6 kB 6.7 MB/s eta 0:00:00
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: opencv-python in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from mmpose==1.1.0) (4.13.0.92)
Requirement already satisfied: pillow in /databricks/python3/lib/python3.10/site-packages (from mmpose==1.1.0) (9.4.0)
Collecting json-tricks
  Downloading json_tricks-3.17.3-py2.py3-none-any.whl (27 kB)
Requirement already satisfied: torchvision in /databricks/python3/lib/python3.10/site-packages (from mmpose==1.1.0) (0.15.2+cu118)
Collecting xtcocotools>=1.12
  Downloading xtcocotools-1.14.3-cp310-cp310-manylinux1_x86_64.whl (436 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 436.0/436.0 kB 38.9 MB/s eta 0:00:00
Collecting munkres
  Downloading munkres-1.1.4-py2.py3-none-any.whl (7.0 kB)
Requirement already satisfied: setuptools>=18.0 in /databricks/python3/lib/python3.10/site-packages (from xtcocotools>=1.12->mmpose==1.1.0) (65.6.3)
Requirement already satisfied: cython>=0.27.3 in /databricks/python3/lib/python3.10/site-packages (from xtcocotools>=1.12->mmpose==1.1.0) (0.29.32)
Requirement already satisfied: cycler>=0.10 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (0.11.0)
Requirement already satisfied: kiwisolver>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (1.4.4)
Requirement already satisfied: fonttools>=4.22.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (4.25.0)
Requirement already satisfied: contourpy>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (1.0.5)
Requirement already satisfied: packaging>=20.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (23.2)
Requirement already satisfied: pyparsing>=2.3.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (3.0.9)
Requirement already satisfied: python-dateutil>=2.7 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (2.8.2)
Collecting numpy
  Using cached numpy-1.26.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (18.2 MB)
Collecting opencv-python
  Downloading opencv_python-4.13.0.90-cp37-abi3-manylinux_2_28_x86_64.whl (72.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 72.9/72.9 MB 7.5 MB/s eta 0:00:00
  Downloading opencv_python-4.12.0.88-cp37-abi3-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (67.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 67.0/67.0 MB 8.6 MB/s eta 0:00:00
  Downloading opencv_python-4.11.0.86-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (63.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 63.0/63.0 MB 4.9 MB/s eta 0:00:00
Collecting torch==2.0.1
  Downloading torch-2.0.1-cp310-cp310-manylinux1_x86_64.whl (619.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 619.9/619.9 MB 515.7 kB/s eta 0:00:00
Requirement already satisfied: requests in /databricks/python3/lib/python3.10/site-packages (from torchvision->mmpose==1.1.0) (2.28.1)
Requirement already satisfied: filelock in /databricks/python3/lib/python3.10/site-packages (from torch==2.0.1->torchvision->mmpose==1.1.0) (3.9.0)
Collecting nvidia-cuda-nvrtc-cu11==11.7.99
  Downloading nvidia_cuda_nvrtc_cu11-11.7.99-2-py3-none-manylinux1_x86_64.whl (21.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 21.0/21.0 MB 21.6 MB/s eta 0:00:00
Collecting nvidia-cuda-runtime-cu11==11.7.99
  Downloading nvidia_cuda_runtime_cu11-11.7.99-py3-none-manylinux1_x86_64.whl (849 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 849.3/849.3 kB 55.9 MB/s eta 0:00:00
Collecting nvidia-cuda-cupti-cu11==11.7.101
  Downloading nvidia_cuda_cupti_cu11-11.7.101-py3-none-manylinux1_x86_64.whl (11.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 11.8/11.8 MB 40.1 MB/s eta 0:00:00
Collecting nvidia-cudnn-cu11==8.5.0.96
  Downloading nvidia_cudnn_cu11-8.5.0.96-2-py3-none-manylinux1_x86_64.whl (557.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 557.1/557.1 MB 688.0 kB/s eta 0:00:00
Collecting nvidia-cublas-cu11==11.10.3.66
  Downloading nvidia_cublas_cu11-11.10.3.66-py3-none-manylinux1_x86_64.whl (317.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 317.1/317.1 MB 1.8 MB/s eta 0:00:00
Collecting nvidia-curand-cu11==10.2.10.91
  Downloading nvidia_curand_cu11-10.2.10.91-py3-none-manylinux1_x86_64.whl (54.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 54.6/54.6 MB 10.0 MB/s eta 0:00:00
Collecting nvidia-cusparse-cu11==11.7.4.91
  Downloading nvidia_cusparse_cu11-11.7.4.91-py3-none-manylinux1_x86_64.whl (173.2 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 173.2/173.2 MB 3.4 MB/s eta 0:00:00
Requirement already satisfied: typing-extensions in /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages (from torch==2.0.1->torchvision->mmpose==1.1.0) (4.15.0)
Requirement already satisfied: jinja2 in /databricks/python3/lib/python3.10/site-packages (from torch==2.0.1->torchvision->mmpose==1.1.0) (3.1.2)
Collecting nvidia-cusolver-cu11==11.4.0.1
  Downloading nvidia_cusolver_cu11-11.4.0.1-2-py3-none-manylinux1_x86_64.whl (102.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 102.6/102.6 MB 5.5 MB/s eta 0:00:00
Collecting triton==2.0.0
  Downloading triton-2.0.0-1-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (63.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 63.3/63.3 MB 9.0 MB/s eta 0:00:00
Collecting nvidia-nvtx-cu11==11.7.91
  Downloading nvidia_nvtx_cu11-11.7.91-py3-none-manylinux1_x86_64.whl (98 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 98.6/98.6 kB 14.3 MB/s eta 0:00:00
Collecting nvidia-nccl-cu11==2.14.3
  Downloading nvidia_nccl_cu11-2.14.3-py3-none-manylinux1_x86_64.whl (177.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 177.1/177.1 MB 3.3 MB/s eta 0:00:00
Requirement already satisfied: sympy in /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages (from torch==2.0.1->torchvision->mmpose==1.1.0) (1.14.0)
Requirement already satisfied: networkx in /databricks/python3/lib/python3.10/site-packages (from torch==2.0.1->torchvision->mmpose==1.1.0) (2.8.4)
Collecting nvidia-cufft-cu11==10.9.0.58
  Downloading nvidia_cufft_cu11-10.9.0.58-py3-none-manylinux2014_x86_64.whl (168.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 168.4/168.4 MB 3.5 MB/s eta 0:00:00
Requirement already satisfied: wheel in /databricks/python3/lib/python3.10/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch==2.0.1->torchvision->mmpose==1.1.0) (0.38.4)
Requirement already satisfied: cmake in /databricks/python3/lib/python3.10/site-packages (from triton==2.0.0->torch==2.0.1->torchvision->mmpose==1.1.0) (3.28.1)
Requirement already satisfied: lit in /databricks/python3/lib/python3.10/site-packages (from triton==2.0.0->torch==2.0.1->torchvision->mmpose==1.1.0) (17.0.6)
Requirement already satisfied: certifi>=2017.4.17 in /databricks/python3/lib/python3.10/site-packages (from requests->torchvision->mmpose==1.1.0) (2022.12.7)
Requirement already satisfied: idna<4,>=2.5 in /databricks/python3/lib/python3.10/site-packages (from requests->torchvision->mmpose==1.1.0) (3.4)
Requirement already satisfied: charset-normalizer<3,>=2 in /databricks/python3/lib/python3.10/site-packages (from requests->torchvision->mmpose==1.1.0) (2.0.4)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /databricks/python3/lib/python3.10/site-packages (from requests->torchvision->mmpose==1.1.0) (1.26.14)
Requirement already satisfied: MarkupSafe>=2.0 in /databricks/python3/lib/python3.10/site-packages (from jinja2->torch==2.0.1->torchvision->mmpose==1.1.0) (2.1.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /databricks/python3/lib/python3.10/site-packages (from sympy->torch==2.0.1->torchvision->mmpose==1.1.0) (1.2.1)
Building wheels for collected packages: chumpy
  Building wheel for chumpy (setup.py): started
  Building wheel for chumpy (setup.py): finished with status 'done'
  Created wheel for chumpy: filename=chumpy-0.70-py3-none-any.whl size=58267 sha256=5d9bac9b1485a106da72064f84dc356c30336208cd3844e6ede4d093d174385f
  Stored in directory: /root/.cache/pip/wheels/31/c3/b2/b4ada5f44179429aa1a5a86ea2d3dba9aaa323703a08b0aa51
Successfully built chumpy
Installing collected packages: munkres, json-tricks, terminaltables, nvidia-nvtx-cu11, nvidia-nccl-cu11, nvidia-cusparse-cu11, nvidia-curand-cu11, nvidia-cufft-cu11, nvidia-cuda-runtime-cu11, nvidia-cuda-nvrtc-cu11, nvidia-cuda-cupti-cu11, nvidia-cublas-cu11, numpy, shapely, pycocotools, opencv-python, nvidia-cusolver-cu11, nvidia-cudnn-cu11, chumpy, xtcocotools, mmdet, triton, torch, mmpose
  Attempting uninstall: numpy
    Found existing installation: numpy 2.2.6
    Uninstalling numpy-2.2.6:
      Successfully uninstalled numpy-2.2.6
  Attempting uninstall: opencv-python
    Found existing installation: opencv-python 4.13.0.92
    Uninstalling opencv-python-4.13.0.92:
      Successfully uninstalled opencv-python-4.13.0.92
  Attempting uninstall: triton
    Found existing installation: triton 3.6.0
    Not uninstalling triton at /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28
    Can't uninstall 'triton'. No files were found to uninstall.
  Attempting uninstall: torch
    Found existing installation: torch 2.10.0
    Not uninstalling torch at /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28
    Can't uninstall 'torch'. No files were found to uninstall.
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
petastorm 0.12.1 requires pyspark>=2.1.0, which is not installed.
databricks-feature-engineering 0.2.1 requires pyspark<4,>=3.1.2, which is not installed.
xformers 0.0.34 requires torch==2.10.0, but you have torch 2.0.1 which is incompatible.
torchaudio 2.10.0 requires torch==2.10.0, but you have torch 2.0.1 which is incompatible.
bitsandbytes 0.49.1 requires torch<3,>=2.3, but you have torch 2.0.1 which is incompatible.
ydata-profiling 4.2.0 requires numpy<1.24,>=1.16.0, but you have numpy 1.26.4 which is incompatible.
ydata-profiling 4.2.0 requires pydantic<2,>=1.8.1, but you have pydantic 2.12.5 which is incompatible.
tensorflow 2.14.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 6.33.5 which is incompatible.
numba 0.56.4 requires numpy<1.24,>=1.18, but you have numpy 1.26.4 which is incompatible.
databricks-feature-engineering 0.2.1 requires mlflow-skinny[databricks]<3,>=2.4.0, but you have mlflow-skinny 3.9.0 which is incompatible.
databricks-feature-engineering 0.2.1 requires protobuf<5,>=3.12.0, but you have protobuf 6.33.5 which is incompatible.
Successfully installed chumpy-0.70 json-tricks-3.17.3 mmdet-3.1.0 mmpose-1.1.0 munkres-1.1.4 numpy-1.26.4 nvidia-cublas-cu11-11.10.3.66 nvidia-cuda-cupti-cu11-11.7.101 nvidia-cuda-nvrtc-cu11-11.7.99 nvidia-cuda-runtime-cu11-11.7.99 nvidia-cudnn-cu11-8.5.0.96 nvidia-cufft-cu11-10.9.0.58 nvidia-curand-cu11-10.2.10.91 nvidia-cusolver-cu11-11.4.0.1 nvidia-cusparse-cu11-11.7.4.91 nvidia-nccl-cu11-2.14.3 nvidia-nvtx-cu11-11.7.91 opencv-python-4.11.0.86 pycocotools-2.0.11 shapely-2.1.2 terminaltables-3.1.10 torch-2.0.1 triton-2.0.0 xtcocotools-1.14.3
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Collecting diffusers==0.30.2
  Using cached diffusers-0.30.2-py3-none-any.whl (2.6 MB)
Collecting transformers==4.39.2
  Using cached transformers-4.39.2-py3-none-any.whl (8.8 MB)
Collecting accelerate==0.28.0
  Using cached accelerate-0.28.0-py3-none-any.whl (290 kB)
Collecting opencv-python==4.9.0.80
  Using cached opencv_python-4.9.0.80-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (62.2 MB)
Requirement already satisfied: soundfile==0.12.1 in /databricks/python3/lib/python3.10/site-packages (0.12.1)
Requirement already satisfied: importlib-metadata in /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages (from diffusers==0.30.2) (8.7.1)
Requirement already satisfied: numpy in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from diffusers==0.30.2) (1.26.4)
Requirement already satisfied: safetensors>=0.3.1 in /databricks/python3/lib/python3.10/site-packages (from diffusers==0.30.2) (0.4.1)
Requirement already satisfied: filelock in /databricks/python3/lib/python3.10/site-packages (from diffusers==0.30.2) (3.9.0)
Requirement already satisfied: Pillow in /databricks/python3/lib/python3.10/site-packages (from diffusers==0.30.2) (9.4.0)
Requirement already satisfied: regex!=2019.12.17 in /databricks/python3/lib/python3.10/site-packages (from diffusers==0.30.2) (2022.7.9)
Requirement already satisfied: requests in /databricks/python3/lib/python3.10/site-packages (from diffusers==0.30.2) (2.28.1)
Requirement already satisfied: huggingface-hub>=0.23.2 in /databricks/python3/lib/python3.10/site-packages (from diffusers==0.30.2) (0.27.1)
Requirement already satisfied: pyyaml>=5.1 in /databricks/python3/lib/python3.10/site-packages (from transformers==4.39.2) (6.0)
Requirement already satisfied: packaging>=20.0 in /databricks/python3/lib/python3.10/site-packages (from transformers==4.39.2) (23.2)
Requirement already satisfied: tqdm>=4.27 in /databricks/python3/lib/python3.10/site-packages (from transformers==4.39.2) (4.64.1)
Requirement already satisfied: tokenizers<0.19,>=0.14 in /databricks/python3/lib/python3.10/site-packages (from transformers==4.39.2) (0.15.0)
Requirement already satisfied: psutil in /databricks/python3/lib/python3.10/site-packages (from accelerate==0.28.0) (5.9.0)
Requirement already satisfied: torch>=1.10.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from accelerate==0.28.0) (2.0.1)
Requirement already satisfied: cffi>=1.0 in /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages (from soundfile==0.12.1) (2.0.0)
Requirement already satisfied: pycparser in /databricks/python3/lib/python3.10/site-packages (from cffi>=1.0->soundfile==0.12.1) (2.21)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages (from huggingface-hub>=0.23.2->diffusers==0.30.2) (4.15.0)
Requirement already satisfied: fsspec>=2023.5.0 in /databricks/python3/lib/python3.10/site-packages (from huggingface-hub>=0.23.2->diffusers==0.30.2) (2023.6.0)
Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (8.5.0.96)
Requirement already satisfied: nvidia-cuda-cupti-cu11==11.7.101 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (11.7.101)
Requirement already satisfied: nvidia-curand-cu11==10.2.10.91 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (10.2.10.91)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (11.7.99)
Requirement already satisfied: nvidia-cusparse-cu11==11.7.4.91 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (11.7.4.91)
Requirement already satisfied: triton==2.0.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (2.0.0)
Requirement already satisfied: nvidia-nvtx-cu11==11.7.91 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (11.7.91)
Requirement already satisfied: jinja2 in /databricks/python3/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (3.1.2)
Requirement already satisfied: nvidia-cufft-cu11==10.9.0.58 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (10.9.0.58)
Requirement already satisfied: nvidia-cusolver-cu11==11.4.0.1 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (11.4.0.1)
Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (11.10.3.66)
Requirement already satisfied: sympy in /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (1.14.0)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (11.7.99)
Requirement already satisfied: nvidia-nccl-cu11==2.14.3 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (2.14.3)
Requirement already satisfied: networkx in /databricks/python3/lib/python3.10/site-packages (from torch>=1.10.0->accelerate==0.28.0) (2.8.4)
Requirement already satisfied: setuptools in /databricks/python3/lib/python3.10/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch>=1.10.0->accelerate==0.28.0) (65.6.3)
Requirement already satisfied: wheel in /databricks/python3/lib/python3.10/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch>=1.10.0->accelerate==0.28.0) (0.38.4)
Requirement already satisfied: lit in /databricks/python3/lib/python3.10/site-packages (from triton==2.0.0->torch>=1.10.0->accelerate==0.28.0) (17.0.6)
Requirement already satisfied: cmake in /databricks/python3/lib/python3.10/site-packages (from triton==2.0.0->torch>=1.10.0->accelerate==0.28.0) (3.28.1)
Requirement already satisfied: zipp>=3.20 in /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages (from importlib-metadata->diffusers==0.30.2) (3.23.0)
Requirement already satisfied: idna<4,>=2.5 in /databricks/python3/lib/python3.10/site-packages (from requests->diffusers==0.30.2) (3.4)
Requirement already satisfied: certifi>=2017.4.17 in /databricks/python3/lib/python3.10/site-packages (from requests->diffusers==0.30.2) (2022.12.7)
Requirement already satisfied: charset-normalizer<3,>=2 in /databricks/python3/lib/python3.10/site-packages (from requests->diffusers==0.30.2) (2.0.4)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /databricks/python3/lib/python3.10/site-packages (from requests->diffusers==0.30.2) (1.26.14)
Requirement already satisfied: MarkupSafe>=2.0 in /databricks/python3/lib/python3.10/site-packages (from jinja2->torch>=1.10.0->accelerate==0.28.0) (2.1.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /databricks/python3/lib/python3.10/site-packages (from sympy->torch>=1.10.0->accelerate==0.28.0) (1.2.1)
Installing collected packages: opencv-python, diffusers, transformers, accelerate
  Attempting uninstall: opencv-python
    Found existing installation: opencv-python 4.11.0.86
    Uninstalling opencv-python-4.11.0.86:
      Successfully uninstalled opencv-python-4.11.0.86
  Attempting uninstall: transformers
    Found existing installation: transformers 4.36.1
    Not uninstalling transformers at /databricks/python3/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28
    Can't uninstall 'transformers'. No files were found to uninstall.
  Attempting uninstall: accelerate
    Found existing installation: accelerate 0.25.0
    Not uninstalling accelerate at /databricks/python3/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-9c15b527-6c3c-4a98-8e66-bba634111e28
    Can't uninstall 'accelerate'. No files were found to uninstall.
Successfully installed accelerate-0.28.0 diffusers-0.30.2 opencv-python-4.9.0.80 transformers-4.39.2
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
