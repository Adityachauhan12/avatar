from cell 4 

            import traceback
            return {"status": "error", "message": f"Error: {str(e)}\n{traceback.format_exc()}"}

print("âœ… Model class defined")
âœ… Model class defined
/local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages/mlflow/pyfunc/utils/data_validation.py:186: UserWarning: Add type hints to the `predict` method to enable data validation and automatic signature inference during model logging. Check https://mlflow.org/docs/latest/model/python_model.html#type-hint-usage-in-pythonmodel for more details.
  color_warning(

from cell 5

ðŸ“¦ Installing PyYAML...

[notice] A new release of pip available: 22.3.1 -> 25.3
[notice] To update, run: pip install --upgrade pip
ðŸ“¦ Creating conda.yaml with PyTorch...
âœ… Conda environment created
ðŸ”„ Preparing repo with checkpoints...
   Cloning repo...
   Applying np.atan2 patch...
   Downloading config from HuggingFace...




   Copying TensorRT engines...
      Copying appearance_extractor_fp16.engine...
      Copying blaze_face_fp16.engine...
      Copying decoder_fp16.engine...
      Copying face_mesh_fp16.engine...
      Copying hubert_fp32.engine...
      Copying insightface_det_fp16.engine...
      Copying landmark106_fp16.engine...
      Copying landmark203_fp16.engine...
      Copying lmdm_v0.4_hubert_fp32.engine...
      Copying motion_extractor_fp32.engine...
      Copying stitch_network_fp16.engine...
      Copying warp_network_fp16.engine...
âœ… Repo prepared with all checkpoints
ðŸ“ Logging model with artifacts...
2026/01/12 10:46:20 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.
ðŸ”— View Logged Model at: https://adb-7012066134936526.6.azuredatabricks.net/ml/experiments/2986770717919245/models/m-91bf1b36dd874a79819c1a336e9ac636?o=7012066134936526
/local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages/mlflow/pyfunc/__init__.py:3285: UserWarning: An input example was not provided when logging the model. To ensure the model signature functions correctly, specify the `input_example` parameter. See https://mlflow.org/docs/latest/model/signatures.html#model-input-example for more details about the benefits of using input_example.
  color_warning(

2026/01/12 10:46:54 WARNING mlflow.utils.requirements_utils: Detected one or more mismatches between the model's dependencies and the current Python environment:
 - torch (current: 2.9.1, required: torch==2.1.2)
 - torchvision (current: 0.15.2+cu118, required: torchvision==0.16.2)
 - torchaudio (current: 2.9.1, required: torchaudio==2.1.2)
 - tensorrt (current: uninstalled, required: tensorrt==9.3.0.post12.dev1)
 - cuda-python (current: uninstalled, required: cuda-python==12.2.0)
 - onnxruntime-gpu (current: uninstalled, required: onnxruntime-gpu==1.16.3)
 - numpy (current: 1.23.5, required: numpy==1.26.4)
 - gitpython (current: 3.1.27, required: gitpython==3.1.40)
 - imageio-ffmpeg (current: uninstalled, required: imageio-ffmpeg)
 - opencv-python-headless (current: uninstalled, required: opencv-python-headless)
 - imageio (current: uninstalled, required: imageio)
 - moviepy (current: uninstalled, required: moviepy)
 - mediapipe (current: uninstalled, required: mediapipe>=0.10.9)
 - ml_dtypes (current: 0.2.0, required: ml_dtypes==0.4.0)
 - omegaconf (current: uninstalled, required: omegaconf)
 - filetype (current: uninstalled, required: filetype)
 - scikit-image (current: uninstalled, required: scikit-image)
 - colored (current: uninstalled, required: colored)
 - polygraphy (current: uninstalled, required: polygraphy)
To fix the mismatches, call `mlflow.pyfunc.get_model_dependencies(model_uri)` to fetch the model's environment and install dependencies using the resulting environment file.
âœ… Model Logged with artifacts. Run ID: 6782d8b2422b4e068d3ee1c332327fc8
Registered model 'lab37_catalog.ifstrolley.ditto_talkinghead' already exists. Creating a new version of this model...
2026/01/12 10:47:10 WARNING mlflow.tracking._model_registry.fluent: Run with id 6782d8b2422b4e068d3ee1c332327fc8 has no artifacts at artifact path 'ditto_talking_head', registering model based on models:/m-91bf1b36dd874a79819c1a336e9ac636 instead



WARNING:urllib3.connectionpool:Connection pool is full, discarding connection: dbstoragekjgtjvcce5eio.dfs.core.windows.net. Connection pool size: 10
ðŸ”— Created version '16' of model 'lab37_catalog.ifstrolley.ditto_talkinghead': https://adb-7012066134936526.6.azuredatabricks.net/explore/data/models/lab37_catalog/ifstrolley/ditto_talkinghead/version/16?o=7012066134936526
âœ… SUCCESS! Registered Version: 16
ðŸ‘‰ Go to Serving â†’ ditto_with_base64 â†’ Update to Version 16
