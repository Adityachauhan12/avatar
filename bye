ğŸš€ FLASH/XFORMERS MOCKED AT LINE 1
âœ… USER PATHS PRIORITY #1
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Looking in indexes: https://download.pytorch.org/whl/cu118
Collecting torch==2.0.1+cu118
  Downloading https://download.pytorch.org/whl/cu118/torch-2.0.1%2Bcu118-cp310-cp310-linux_x86_64.whl (2267.3 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 2.3/2.3 GB ? eta 0:00:00
Collecting torchvision==0.15.2
  Downloading https://download.pytorch.org/whl/cu118/torchvision-0.15.2%2Bcu118-cp310-cp310-linux_x86_64.whl (6.1 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 6.1/6.1 MB 70.5 MB/s eta 0:00:00
Installing collected packages: torchvision, torch
  Attempting uninstall: torchvision
    Found existing installation: torchvision 0.15.2+cu118
    Not uninstalling torchvision at /databricks/python3/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199
    Can't uninstall 'torchvision'. No files were found to uninstall.
  Attempting uninstall: torch
    Found existing installation: torch 2.10.0
    Not uninstalling torch at /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199
    Can't uninstall 'torch'. No files were found to uninstall.
Successfully installed torch-2.0.1+cu118 torchvision-0.15.2+cu118
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
âœ… PyTorch: 2.10.0+cu128 CUDA: True
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Collecting mmengine==0.10.3
  Downloading mmengine-0.10.3-py3-none-any.whl (451 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 451.7/451.7 kB 11.8 MB/s eta 0:00:00
Requirement already satisfied: pyyaml in /databricks/python3/lib/python3.10/site-packages (from mmengine==0.10.3) (6.0)
Requirement already satisfied: termcolor in /databricks/python3/lib/python3.10/site-packages (from mmengine==0.10.3) (2.4.0)
Requirement already satisfied: matplotlib in /databricks/python3/lib/python3.10/site-packages (from mmengine==0.10.3) (3.7.0)
Requirement already satisfied: yapf in /databricks/python3/lib/python3.10/site-packages (from mmengine==0.10.3) (0.33.0)
Requirement already satisfied: numpy in /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages (from mmengine==0.10.3) (1.26.4)
Collecting opencv-python>=3
  Downloading opencv_python-4.13.0.92-cp37-abi3-manylinux_2_28_x86_64.whl (72.9 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 72.9/72.9 MB 7.8 MB/s eta 0:00:00
Collecting rich
  Downloading rich-14.3.2-py3-none-any.whl (309 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 310.0/310.0 kB 30.7 MB/s eta 0:00:00
Collecting addict
  Downloading addict-2.4.0-py3-none-any.whl (3.8 kB)
Collecting numpy
  Downloading numpy-2.2.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.8 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 16.8/16.8 MB 31.1 MB/s eta 0:00:00
Requirement already satisfied: cycler>=0.10 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine==0.10.3) (0.11.0)
Requirement already satisfied: packaging>=20.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine==0.10.3) (23.2)
Requirement already satisfied: pillow>=6.2.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine==0.10.3) (9.4.0)
Requirement already satisfied: contourpy>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine==0.10.3) (1.0.5)
Requirement already satisfied: kiwisolver>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine==0.10.3) (1.4.4)
Requirement already satisfied: pyparsing>=2.3.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine==0.10.3) (3.0.9)
Requirement already satisfied: fonttools>=4.22.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine==0.10.3) (4.25.0)
Requirement already satisfied: python-dateutil>=2.7 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine==0.10.3) (2.8.2)
Collecting pygments<3.0.0,>=2.13.0
  Downloading pygments-2.19.2-py3-none-any.whl (1.2 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 1.2/1.2 MB 56.3 MB/s eta 0:00:00
Collecting markdown-it-py>=2.2.0
  Downloading markdown_it_py-4.0.0-py3-none-any.whl (87 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 87.3/87.3 kB 11.9 MB/s eta 0:00:00
Requirement already satisfied: tomli>=2.0.1 in /databricks/python3/lib/python3.10/site-packages (from yapf->mmengine==0.10.3) (2.0.1)
Collecting mdurl~=0.1
  Downloading mdurl-0.1.2-py3-none-any.whl (10.0 kB)
Requirement already satisfied: six>=1.5 in /usr/lib/python3/dist-packages (from python-dateutil>=2.7->matplotlib->mmengine==0.10.3) (1.16.0)
Installing collected packages: addict, pygments, numpy, mdurl, opencv-python, markdown-it-py, rich, mmengine
  Attempting uninstall: pygments
    Found existing installation: Pygments 2.11.2
    Not uninstalling pygments at /databricks/python3/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199
    Can't uninstall 'Pygments'. No files were found to uninstall.
  Attempting uninstall: numpy
    Found existing installation: numpy 1.26.4
    Not uninstalling numpy at /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199
    Can't uninstall 'numpy'. No files were found to uninstall.
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
petastorm 0.12.1 requires pyspark>=2.1.0, which is not installed.
nbclassic 0.5.2 requires prometheus-client, which is not installed.
jupyter-server 1.23.4 requires prometheus-client, which is not installed.
databricks-feature-engineering 0.2.1 requires pyspark<4,>=3.1.2, which is not installed.
xformers 0.0.34 requires torch==2.10.0, but you have torch 2.0.1+cu118 which is incompatible.
bitsandbytes 0.49.1 requires torch<3,>=2.3, but you have torch 2.0.1+cu118 which is incompatible.
ydata-profiling 4.2.0 requires numpy<1.24,>=1.16.0, but you have numpy 2.2.6 which is incompatible.
ydata-profiling 4.2.0 requires pydantic<2,>=1.8.1, but you have pydantic 2.12.5 which is incompatible.
tensorflow 2.14.1 requires numpy<2.0.0,>=1.23.5, but you have numpy 2.2.6 which is incompatible.
tensorflow 2.14.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 6.33.5 which is incompatible.
scipy 1.10.0 requires numpy<1.27.0,>=1.19.5, but you have numpy 2.2.6 which is incompatible.
numba 0.56.4 requires numpy<1.24,>=1.18, but you have numpy 2.2.6 which is incompatible.
langchain 0.0.348 requires numpy<2,>=1, but you have numpy 2.2.6 which is incompatible.
jupyter-server 1.23.4 requires anyio<4,>=3.1.0, but you have anyio 4.12.1 which is incompatible.
databricks-feature-engineering 0.2.1 requires mlflow-skinny[databricks]<3,>=2.4.0, but you have mlflow-skinny 3.9.0 which is incompatible.
databricks-feature-engineering 0.2.1 requires numpy<2,>=1.19.2, but you have numpy 2.2.6 which is incompatible.
databricks-feature-engineering 0.2.1 requires protobuf<5,>=3.12.0, but you have protobuf 6.33.5 which is incompatible.
Successfully installed addict-2.4.0 markdown-it-py-4.0.0 mdurl-0.1.2 mmengine-0.10.3 numpy-2.2.6 opencv-python-4.13.0.92 pygments-2.19.2 rich-14.3.2
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Collecting mmdet==3.1.0
  Downloading mmdet-3.1.0-py3-none-any.whl (2.0 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 2.0/2.0 MB 31.0 MB/s eta 0:00:00
Collecting terminaltables
  Downloading terminaltables-3.1.10-py2.py3-none-any.whl (15 kB)
Collecting shapely
  Downloading shapely-2.1.2-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (3.1 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 3.1/3.1 MB 76.9 MB/s eta 0:00:00
Requirement already satisfied: six in /usr/lib/python3/dist-packages (from mmdet==3.1.0) (1.16.0)
Collecting pycocotools
  Downloading pycocotools-2.0.11-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (472 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 472.5/472.5 kB 41.5 MB/s eta 0:00:00
Requirement already satisfied: numpy in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from mmdet==3.1.0) (2.2.6)
Requirement already satisfied: scipy in /databricks/python3/lib/python3.10/site-packages (from mmdet==3.1.0) (1.10.0)
Requirement already satisfied: matplotlib in /databricks/python3/lib/python3.10/site-packages (from mmdet==3.1.0) (3.7.0)
Requirement already satisfied: cycler>=0.10 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (0.11.0)
Requirement already satisfied: kiwisolver>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (1.4.4)
Requirement already satisfied: pillow>=6.2.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (9.4.0)
Requirement already satisfied: pyparsing>=2.3.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (3.0.9)
Requirement already satisfied: python-dateutil>=2.7 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (2.8.2)
Requirement already satisfied: contourpy>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (1.0.5)
Requirement already satisfied: fonttools>=4.22.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (4.25.0)
Requirement already satisfied: packaging>=20.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmdet==3.1.0) (23.2)
Collecting numpy
  Downloading numpy-1.26.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (18.2 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 18.2/18.2 MB 23.8 MB/s eta 0:00:00
Installing collected packages: terminaltables, numpy, shapely, pycocotools, mmdet
  Attempting uninstall: numpy
    Found existing installation: numpy 2.2.6
    Uninstalling numpy-2.2.6:
      Successfully uninstalled numpy-2.2.6
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
petastorm 0.12.1 requires pyspark>=2.1.0, which is not installed.
databricks-feature-engineering 0.2.1 requires pyspark<4,>=3.1.2, which is not installed.
opencv-python 4.13.0.92 requires numpy>=2; python_version >= "3.9", but you have numpy 1.26.4 which is incompatible.
xformers 0.0.34 requires torch==2.10.0, but you have torch 2.0.1+cu118 which is incompatible.
bitsandbytes 0.49.1 requires torch<3,>=2.3, but you have torch 2.0.1+cu118 which is incompatible.
ydata-profiling 4.2.0 requires numpy<1.24,>=1.16.0, but you have numpy 1.26.4 which is incompatible.
ydata-profiling 4.2.0 requires pydantic<2,>=1.8.1, but you have pydantic 2.12.5 which is incompatible.
tensorflow 2.14.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 6.33.5 which is incompatible.
numba 0.56.4 requires numpy<1.24,>=1.18, but you have numpy 1.26.4 which is incompatible.
databricks-feature-engineering 0.2.1 requires mlflow-skinny[databricks]<3,>=2.4.0, but you have mlflow-skinny 3.9.0 which is incompatible.
databricks-feature-engineering 0.2.1 requires protobuf<5,>=3.12.0, but you have protobuf 6.33.5 which is incompatible.
Successfully installed mmdet-3.1.0 numpy-1.26.4 pycocotools-2.0.11 shapely-2.1.2 terminaltables-3.1.10
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Collecting mmpose==1.1.0
  Downloading mmpose-1.1.0-py2.py3-none-any.whl (1.3 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 1.3/1.3 MB 26.0 MB/s eta 0:00:00
Requirement already satisfied: matplotlib in /databricks/python3/lib/python3.10/site-packages (from mmpose==1.1.0) (3.7.0)
Requirement already satisfied: pillow in /databricks/python3/lib/python3.10/site-packages (from mmpose==1.1.0) (9.4.0)
Requirement already satisfied: torchvision in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from mmpose==1.1.0) (0.15.2+cu118)
Collecting munkres
  Downloading munkres-1.1.4-py2.py3-none-any.whl (7.0 kB)
Requirement already satisfied: scipy in /databricks/python3/lib/python3.10/site-packages (from mmpose==1.1.0) (1.10.0)
Requirement already satisfied: numpy in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from mmpose==1.1.0) (1.26.4)
Collecting chumpy
  Downloading chumpy-0.70.tar.gz (50 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 50.6/50.6 kB 6.7 MB/s eta 0:00:00
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: opencv-python in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from mmpose==1.1.0) (4.13.0.92)
Collecting xtcocotools>=1.12
  Downloading xtcocotools-1.14.3-cp310-cp310-manylinux1_x86_64.whl (436 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 436.0/436.0 kB 39.8 MB/s eta 0:00:00
Collecting json-tricks
  Downloading json_tricks-3.17.3-py2.py3-none-any.whl (27 kB)
Requirement already satisfied: cython>=0.27.3 in /databricks/python3/lib/python3.10/site-packages (from xtcocotools>=1.12->mmpose==1.1.0) (0.29.32)
Requirement already satisfied: setuptools>=18.0 in /databricks/python3/lib/python3.10/site-packages (from xtcocotools>=1.12->mmpose==1.1.0) (65.6.3)
Requirement already satisfied: pyparsing>=2.3.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmpose==1.1.0) (3.0.9)
Requirement already satisfied: python-dateutil>=2.7 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmpose==1.1.0) (2.8.2)
Requirement already satisfied: fonttools>=4.22.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmpose==1.1.0) (4.25.0)
Requirement already satisfied: cycler>=0.10 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmpose==1.1.0) (0.11.0)
Requirement already satisfied: packaging>=20.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmpose==1.1.0) (23.2)
Requirement already satisfied: kiwisolver>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmpose==1.1.0) (1.4.4)
Requirement already satisfied: contourpy>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmpose==1.1.0) (1.0.5)
Requirement already satisfied: six>=1.11.0 in /usr/lib/python3/dist-packages (from chumpy->mmpose==1.1.0) (1.16.0)
Collecting opencv-python
  Downloading opencv_python-4.13.0.90-cp37-abi3-manylinux_2_28_x86_64.whl (72.9 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 72.9/72.9 MB 7.5 MB/s eta 0:00:00
  Downloading opencv_python-4.12.0.88-cp37-abi3-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (67.0 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 67.0/67.0 MB 8.6 MB/s eta 0:00:00
  Downloading opencv_python-4.11.0.86-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (63.0 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 63.0/63.0 MB 8.9 MB/s eta 0:00:00
Requirement already satisfied: torch==2.0.1 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from torchvision->mmpose==1.1.0) (2.0.1+cu118)
Requirement already satisfied: requests in /databricks/python3/lib/python3.10/site-packages (from torchvision->mmpose==1.1.0) (2.28.1)
Requirement already satisfied: networkx in /databricks/python3/lib/python3.10/site-packages (from torch==2.0.1->torchvision->mmpose==1.1.0) (2.8.4)
Requirement already satisfied: jinja2 in /databricks/python3/lib/python3.10/site-packages (from torch==2.0.1->torchvision->mmpose==1.1.0) (3.1.2)
Requirement already satisfied: typing-extensions in /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages (from torch==2.0.1->torchvision->mmpose==1.1.0) (4.15.0)
Requirement already satisfied: filelock in /databricks/python3/lib/python3.10/site-packages (from torch==2.0.1->torchvision->mmpose==1.1.0) (3.9.0)
Requirement already satisfied: sympy in /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages (from torch==2.0.1->torchvision->mmpose==1.1.0) (1.14.0)
Collecting triton==2.0.0
  Downloading triton-2.0.0-1-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (63.3 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 63.3/63.3 MB 8.5 MB/s eta 0:00:00
Requirement already satisfied: cmake in /databricks/python3/lib/python3.10/site-packages (from triton==2.0.0->torch==2.0.1->torchvision->mmpose==1.1.0) (3.28.1)
Requirement already satisfied: lit in /databricks/python3/lib/python3.10/site-packages (from triton==2.0.0->torch==2.0.1->torchvision->mmpose==1.1.0) (17.0.6)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /databricks/python3/lib/python3.10/site-packages (from requests->torchvision->mmpose==1.1.0) (1.26.14)
Requirement already satisfied: idna<4,>=2.5 in /databricks/python3/lib/python3.10/site-packages (from requests->torchvision->mmpose==1.1.0) (3.4)
Requirement already satisfied: charset-normalizer<3,>=2 in /databricks/python3/lib/python3.10/site-packages (from requests->torchvision->mmpose==1.1.0) (2.0.4)
Requirement already satisfied: certifi>=2017.4.17 in /databricks/python3/lib/python3.10/site-packages (from requests->torchvision->mmpose==1.1.0) (2022.12.7)
Requirement already satisfied: MarkupSafe>=2.0 in /databricks/python3/lib/python3.10/site-packages (from jinja2->torch==2.0.1->torchvision->mmpose==1.1.0) (2.1.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /databricks/python3/lib/python3.10/site-packages (from sympy->torch==2.0.1->torchvision->mmpose==1.1.0) (1.2.1)
Building wheels for collected packages: chumpy
  Building wheel for chumpy (setup.py): started
  Building wheel for chumpy (setup.py): finished with status 'done'
  Created wheel for chumpy: filename=chumpy-0.70-py3-none-any.whl size=58267 sha256=fd2bd938b313a7bab8d9dce0483ed451e8019f06a05fb3829a5aca17215b5ecf
  Stored in directory: /root/.cache/pip/wheels/31/c3/b2/b4ada5f44179429aa1a5a86ea2d3dba9aaa323703a08b0aa51
Successfully built chumpy
Installing collected packages: munkres, json-tricks, opencv-python, chumpy, xtcocotools, triton, mmpose
  Attempting uninstall: opencv-python
    Found existing installation: opencv-python 4.13.0.92
    Uninstalling opencv-python-4.13.0.92:
      Successfully uninstalled opencv-python-4.13.0.92
  Attempting uninstall: triton
    Found existing installation: triton 3.6.0
    Not uninstalling triton at /local_disk0/.ephemeral_nfs/cluster_libraries/python/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199
    Can't uninstall 'triton'. No files were found to uninstall.
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
xformers 0.0.34 requires torch==2.10.0, but you have torch 2.0.1+cu118 which is incompatible.
torchaudio 2.10.0 requires torch==2.10.0, but you have torch 2.0.1+cu118 which is incompatible.
bitsandbytes 0.49.1 requires torch<3,>=2.3, but you have torch 2.0.1+cu118 which is incompatible.
Successfully installed chumpy-0.70 json-tricks-3.17.3 mmpose-1.1.0 munkres-1.1.4 opencv-python-4.11.0.86 triton-2.0.0 xtcocotools-1.14.3
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Looking in links: https://download.openmmlab.com/mmcv/dist/cu118/torch2.0/index.html
Collecting mmcv==2.0.1
  Downloading https://download.openmmlab.com/mmcv/dist/cu118/torch2.0.0/mmcv-2.0.1-cp310-cp310-manylinux1_x86_64.whl (74.4 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 74.4/74.4 MB 6.9 MB/s eta 0:00:00
Requirement already satisfied: Pillow in /databricks/python3/lib/python3.10/site-packages (from mmcv==2.0.1) (9.4.0)
Requirement already satisfied: yapf in /databricks/python3/lib/python3.10/site-packages (from mmcv==2.0.1) (0.33.0)
Requirement already satisfied: addict in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from mmcv==2.0.1) (2.4.0)
Requirement already satisfied: pyyaml in /databricks/python3/lib/python3.10/site-packages (from mmcv==2.0.1) (6.0)
Requirement already satisfied: packaging in /databricks/python3/lib/python3.10/site-packages (from mmcv==2.0.1) (23.2)
Requirement already satisfied: numpy in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from mmcv==2.0.1) (1.26.4)
Requirement already satisfied: mmengine>=0.3.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from mmcv==2.0.1) (0.10.3)
Requirement already satisfied: opencv-python>=3 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from mmcv==2.0.1) (4.11.0.86)
Requirement already satisfied: rich in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from mmengine>=0.3.0->mmcv==2.0.1) (14.3.2)
Requirement already satisfied: termcolor in /databricks/python3/lib/python3.10/site-packages (from mmengine>=0.3.0->mmcv==2.0.1) (2.4.0)
Requirement already satisfied: matplotlib in /databricks/python3/lib/python3.10/site-packages (from mmengine>=0.3.0->mmcv==2.0.1) (3.7.0)
Requirement already satisfied: tomli>=2.0.1 in /databricks/python3/lib/python3.10/site-packages (from yapf->mmcv==2.0.1) (2.0.1)
Requirement already satisfied: pyparsing>=2.3.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (3.0.9)
Requirement already satisfied: fonttools>=4.22.0 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (4.25.0)
Requirement already satisfied: cycler>=0.10 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (0.11.0)
Requirement already satisfied: kiwisolver>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (1.4.4)
Requirement already satisfied: python-dateutil>=2.7 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (2.8.2)
Requirement already satisfied: contourpy>=1.0.1 in /databricks/python3/lib/python3.10/site-packages (from matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (1.0.5)
Requirement already satisfied: markdown-it-py>=2.2.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from rich->mmengine>=0.3.0->mmcv==2.0.1) (4.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from rich->mmengine>=0.3.0->mmcv==2.0.1) (2.19.2)
Requirement already satisfied: mdurl~=0.1 in /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages (from markdown-it-py>=2.2.0->rich->mmengine>=0.3.0->mmcv==2.0.1) (0.1.2)
Requirement already satisfied: six>=1.5 in /usr/lib/python3/dist-packages (from python-dateutil>=2.7->matplotlib->mmengine>=0.3.0->mmcv==2.0.1) (1.16.0)
Installing collected packages: mmcv
Successfully installed mmcv-2.0.1
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Collecting transformers==4.39.2
  Downloading transformers-4.39.2-py3-none-any.whl (8.8 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 8.8/8.8 MB 41.1 MB/s eta 0:00:00
Installing collected packages: transformers
  Attempting uninstall: transformers
    Found existing installation: transformers 4.36.1
    Not uninstalling transformers at /databricks/python3/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199
    Can't uninstall 'transformers'. No files were found to uninstall.
Successfully installed transformers-4.39.2
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
Collecting diffusers==0.30.2
  Downloading diffusers-0.30.2-py3-none-any.whl (2.6 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 2.6/2.6 MB 40.8 MB/s eta 0:00:00
Collecting accelerate==0.27.2
  Downloading accelerate-0.27.2-py3-none-any.whl (279 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 280.0/280.0 kB 32.2 MB/s eta 0:00:00
Installing collected packages: diffusers, accelerate
  Attempting uninstall: accelerate
    Found existing installation: accelerate 0.25.0
    Not uninstalling accelerate at /databricks/python3/lib/python3.10/site-packages, outside environment /local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199
    Can't uninstall 'accelerate'. No files were found to uninstall.
Successfully installed accelerate-0.27.2 diffusers-0.30.2
Note: you may need to restart the kernel using dbutils.library.restartPython() to use updated packages.
2026-02-11 06:52:26.877844: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2026-02-11 06:52:26.877916: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-02-11 06:52:26.877959: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2026-02-11 06:52:26.892829: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Unexpected internal error when monkey patching `Trainer.train`: Failed to import transformers.trainer because of the following error (look up to see its traceback):
cannot import name 'clear_device_cache' from 'accelerate.utils.memory' (/local_disk0/.ephemeral_nfs/envs/pythonEnv-f8db38dd-d899-4bb1-9f3c-18a302b25199/lib/python3.10/site-packages/accelerate/utils/memory.py)RuntimeError: Failed to import transformers.models.whisper.modeling_whisper because of the following error (look up to see its traceback):
flash_attn.__spec__ is not set
