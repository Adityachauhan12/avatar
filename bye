import requests

print("ğŸ§ª Testing /generate endpoint...\n")

audio_file = "/Volumes/lab37_catalog/ifstrolley/trolley/Thank you for bookin (1).wav"
image_file = "/Volumes/lab37_catalog/ifstrolley/trolley/new.png"

print(f"ğŸ“ Audio: {audio_file}")
print(f"ğŸ“ Image: {image_file}\n")

files = {
    'audio': open(audio_file, 'rb'),
    'image': open(image_file, 'rb'),
}
data = {
    'num_frames': 50,
    'face_scale': 2.3
}

print("ğŸ“¤ Sending request to /generate...\n")

try:
    response = requests.post(
        'http://localhost:8000/generate',
        files=files,
        data=data,
        timeout=600  # 10 min timeout
    )
    
    result = response.json()
    
    print("âœ… Response received!")
    print(f"\nğŸ“Š Task Details:")
    print(f"   Task ID: {result['task_id']}")
    print(f"   Status: {result['status']}")
    if result['status'] == 'completed':
        print(f"   Inference time: {result['inference_time']}s")
        print(f"   Video path: {result['video_path']}")
    else:
        print(f"   Error: {result.get('error', 'Unknown error')}")
    
except Exception as e:
    print(f"âŒ Error: {str(e)}")
