# ============================================================================
# CELL 4: UNITY CATALOG VERSION (Production)
# ============================================================================

# YOUR CATALOG PATHS (Perfect!)
INPUT_VIDEO = "/Volumes/lab37_catalog/ifstrolley/trolley/input.mp4"
NEW_AUDIO = "/Volumes/lab37_catalog/ifstrolley/trolley/audio.wav" 
OUTPUT_VIDEO = "/Volumes/lab37_catalog/ifstrolley/trolley/output.mp4"

print("ğŸ“ CATALOG PATHS:")
print(f"Input:  {INPUT_VIDEO}")
print(f"Audio:  {NEW_AUDIO}")
print(f"Output: {OUTPUT_VIDEO}")

# ğŸ” Verify files exist
print("\nğŸ” CHECKING FILES...")
for path, name in [(INPUT_VIDEO, "Video"), (NEW_AUDIO, "Audio")]:
    exists = os.path.exists(path)
    print(f"{name}: {'âœ…' if exists else 'âŒ'} {path}")

# ğŸ¬ PROCESS (FFmpeg magic)
if os.path.exists(INPUT_VIDEO) and os.path.exists(NEW_AUDIO):
    print("\nğŸš€ PROCESSING...")
    
    cmd = f'''
    ffmpeg -y -i "{INPUT_VIDEO}" -i "{NEW_AUDIO}" \
        -c:v copy -c:a aac -b:a 320k \
        -map 0:v:0 -map 1:a:0 \
        -shortest -movflags +faststart \
        "{OUTPUT_VIDEO}" -loglevel error
    '''
    
    result = os.system(cmd)
    if result == 0:
        print(f"\nğŸ‰ SUCCESS! ğŸ¬")
        print(f"ğŸ“¥ Output: {OUTPUT_VIDEO}")
        print("âœ… Perfect audio sync - Hollywood quality!")
    else:
        print("âŒ FFmpeg failed")
else:
    print("\nğŸ’¡ UPLOAD FILES FIRST:")
    print("   Catalog â†’ lab37_catalog â†’ ifstrolley â†’ trolley")
    print("   Upload: input.mp4 + audio.wav")
